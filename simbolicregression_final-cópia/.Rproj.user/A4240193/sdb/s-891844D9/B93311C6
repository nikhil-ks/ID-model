{
    "collab_server" : "",
    "contents" : "S <- function(initialRL,Y,X) {\n\n  Y <- as.matrix(Y)\n  X <- as.matrix(X)\n\n  YC <- as.matrix(Y[, 1])                                      #matriz com os centros da variável resposta\n  YR <- as.matrix(Y[, 2])                                      #matriz com os raios da variável resposta\n  YM <- as.matrix(Y[, 3])                                      #matriz com as modas da variável resposta\n  XC <- as.matrix(X[, seq(from = 1, to = ncol(X), by = 3)])    #matriz com os centros das variaveis explicativas\n  XR <- as.matrix(X[, seq(from = 2, to = ncol(X), by = 3)])    #matriz com os raios das variáveis explicativas\n  XM <- as.matrix(X[, seq(from = 3, to = ncol(X), by = 3)])    #matriz com as modas das variáveis explicativas\n  p  <- ncol(XC)                                               #número de variáveis\n  n  <- nrow(X)                                                #número de observações\n\n  alfa  <- initialRL[1]\n  beta  <- initialRL[2]\n\n  try(if(p > 1) stop(\"*****model only supports one variable*****\"))\n\n##################################################################################################################\n\n  sum   <- 0\n  DM    <- 0\n  Ycest <- 0\n  Yrest <- 0\n  Ymest <- 0\n  t     <- 0\n\n\n\n  for(i in 1:n) {\n    Yc <- YC[i, ]\n    Yr <- YR[i, ]\n    Ym <- YM[i, ]\n\n    Xc <- XC[i, ]\n    Xr <- XR[i, ]\n    Xm <- XM[i, ]\n    Xa <- Xc - Xr\n    Xb <- Xc + Xr\n\n    if((Xm-Xa) > (Xb-Xm)) {\n      t <- (alfa^(2/3))/((alfa^(2/3)) + beta^(2/3))\n      if((t>((Xb-Xm)/(Xb-Xa)))&(t<((Xm-Xa)/(Xb-Xa)))){\n        Ymest <- (alfa-beta)*Xa + sqrt((Xb-Xa)*(Xm-Xa))*((alfa^(4/3)-beta^(4/3))/sqrt(alfa^(2/3)+beta^(2/3)))\n        Yaest <- alfa * Xa - beta * Xb\n        Ybest <- alfa * Xb - beta * Xa\n      } else if(alfa < ((beta*(Xb-Xm)^(3/2))/(Xm-Xa)^(3/2))) {\n        Ymest <- alfa * Xa - beta * Xm + alfa * sqrt((Xb-Xm) * (Xm-Xa))\n        Yaest <- alfa * Xa - beta * Xb\n        Ybest <- alfa * Xb - beta * Xa\n      } else if(alfa > ((beta*(Xm-Xa)^(3/2))/(Xb-Xm)^(3/2))) {\n        Ymest <- alfa * Xm - beta * Xa + beta * sqrt((Xb-Xm) * (Xm-Xa))\n        Yaest <- alfa * Xa - beta * Xb\n        Ybest <- alfa * Xb - beta * Xa\n      }\n    }\n    else {\n      if((Xm-Xa) < (Xb-Xm)) {\n        t <- (beta^(2/3))/((alfa^(2/3)) + beta^(2/3))\n        if((t>((Xm-Xa)/(Xb-Xa)))&(t<((Xb-Xm)/(Xb-Xa)))){\n          Ymest <- (alfa-beta)*Xb + sqrt((Xb-Xa)*(Xb-Xm))*((beta^(4/3)-alfa^(4/3))/sqrt(alfa^(2/3)+beta^(2/3)))\n          Yaest <- alfa * Xa - beta * Xb\n          Ybest <- alfa * Xb - beta * Xa\n        } else if(alfa < ((beta*(Xm-Xa)^(3/2))/(Xb-Xm)^(3/2))) {\n          Ymest <- alfa * Xb - beta * Xm + alfa * sqrt((Xb-Xm) * (Xm-Xa))\n          Yaest <- alfa * Xa - beta * Xb\n          Ybest <- alfa * Xb - beta * Xa\n        } else if(alfa > ((beta*(Xb-Xm)^(3/2))/(Xm-Xa)^(3/2))) {\n          Ymest <- alfa * Xm - beta * Xb + alfa * sqrt((Xb-Xm) * (Xm-Xa))\n          Yaest <- alfa * Xa - beta * Xb\n          Ybest <- alfa * Xb - beta * Xa\n        } else if((Xm-Xa) < (Xb-Xm)) {\n          Yaest <- alfa * Xa - beta * Xb\n          Ybest <- alfa * Xb - beta * Xa\n          Ymest <- (Ybest + Yaest)/2\n        }\n      }\n    }\n\n    Ycest <- (Ybest + Yaest)/2\n    Yrest <- (Ybest - Yaest)/2\n\n    DM <- DistMallows2(Yc,Yr,Ym,Ycest,Yrest,Ymest)\n    sum <- sum + DM # CONFIRMAR\n  }\n\n  return(sum)\n}\n",
    "created" : 1504958536427.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2260110919",
    "id" : "B93311C6",
    "lastKnownWriteTime" : 1502633460,
    "last_content_update" : 1502633460,
    "path" : "C:/Users/pjmalaquias/OneDrive - SONAE/Pessoal/Mestrado/simbolicregression_final/R/funçaoS.R",
    "project_path" : "R/funçaoS.R",
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}